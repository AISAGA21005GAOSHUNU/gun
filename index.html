<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>圖片認字：槍的中文</title>
  <style>
    body{font-family: system-ui, -apple-system, "Noto Sans TC", Arial; margin:0; background:#f6f7fb;}
    header{padding:16px 18px; background:white; box-shadow:0 1px 6px rgba(0,0,0,.08);}
    h1{font-size:18px; margin:0;}
    .wrap{max-width:900px; margin:0 auto; padding:16px;}
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:16px;}
    @media (max-width:760px){ .row{grid-template-columns:1fr;} }
    .card{background:white; border-radius:16px; padding:16px; box-shadow:0 6px 18px rgba(0,0,0,.08);}
    .svgBox{display:flex; align-items:center; justify-content:center; height:240px; background:#fafafa; border-radius:14px; border:1px solid #eee;}
    .choices{display:grid; grid-template-columns:1fr; gap:10px; margin-top:12px;}
    button.choice{font-size:18px; padding:12px 14px; border-radius:12px; border:1px solid #ddd; background:#fff; cursor:pointer;}
    button.choice:hover{background:#f1f5ff;}
    .meta{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;}
    .pill{font-size:12px; padding:6px 10px; border-radius:999px; background:#eef2ff; border:1px solid #dfe6ff;}
    .ok{background:#e9fbe9; border-color:#bfe8bf;}
    .bad{background:#ffecec; border-color:#ffbdbd;}
    .msg{min-height:44px; margin-top:10px; padding:10px 12px; border-radius:12px; background:#fafafa; border:1px solid #eee;}
    .small{font-size:12px; color:#666; margin-top:10px; line-height:1.5;}
    .controls{display:flex; gap:10px; flex-wrap:wrap;}
    .controls label{display:flex; gap:8px; align-items:center; font-size:14px;}
  </style>
</head>
<body>
<header>
  <div class="wrap meta">
    <h1>圖片認字：槍的中文（安全版：只學詞語）</h1>
    <div class="controls">
      <label><input id="tts" type="checkbox" /> 中文朗讀</label>
      <button id="nextBtn" class="choice" style="font-size:14px;padding:8px 12px;">換一題</button>
    </div>
  </div>
</header>

<div class="wrap row">
  <div class="card">
    <div class="svgBox" id="imgBox"></div>
    <div class="small">
      提醒：今天只學「中文詞語」。看到危險物品要遠離並告訴大人。
    </div>
  </div>

  <div class="card">
    <div class="meta">
      <div class="pill">分數：<span id="score">0</span></div>
      <div class="pill">題數：<span id="count">0</span></div>
      <div class="pill" id="levelPill">提示：—</div>
    </div>

    <div class="choices" id="choices"></div>
    <div class="msg" id="msg">看圖片，選正確的中文詞。</div>
  </div>
</div>

<script>
  // 用「簡化圖示」代表類型：避免逼真武器畫面
  const items = [
    { zh:"手槍", hint:"小", svg: pistolSVG() },
    { zh:"步槍", hint:"長", svg: rifleSVG() },
    { zh:"霰彈槍", hint:"吵", svg: shotgunSVG() },
    { zh:"衝鋒槍", hint:"快", svg: smgSVG() },
    { zh:"狙擊槍", hint:"準", svg: sniperSVG() },
    { zh:"機槍", hint:"很大", svg: mgSVG() },
  ];

  let score = 0, count = 0;
  let current = null;

  const imgBox = document.getElementById("imgBox");
  const choicesBox = document.getElementById("choices");
  const msg = document.getElementById("msg");
  const scoreEl = document.getElementById("score");
  const countEl = document.getElementById("count");
  const levelPill = document.getElementById("levelPill");
  const tts = document.getElementById("tts");

  document.getElementById("nextBtn").addEventListener("click", newRound);

  function speak(text){
    if(!tts.checked) return;
    if(!("speechSynthesis" in window)) return;
    const u = new SpeechSynthesisUtterance(text);
    u.lang = "zh-TW";
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]] = [a[j],a[i]];
    }
    return a;
  }

  function pickChoices(correctZh){
    // 3 選 1：正確 + 2 個干擾
    const others = items.filter(x => x.zh !== correctZh).map(x => x.zh);
    const distractors = shuffle(others).slice(0,2);
    return shuffle([correctZh, ...distractors]);
  }

  function setMsg(text, type){
    msg.textContent = text;
    msg.className = "msg" + (type ? (" " + type) : "");
  }

  function newRound(){
    current = items[Math.floor(Math.random()*items.length)];
    count += 1;
    countEl.textContent = String(count);

    imgBox.innerHTML = current.svg;
    levelPill.textContent = "提示：" + current.hint;

    const opts = pickChoices(current.zh);
    choicesBox.innerHTML = "";
    opts.forEach(opt => {
      const b = document.createElement("button");
      b.className = "choice";
      b.textContent = opt;
      b.addEventListener("click", () => choose(opt));
      choicesBox.appendChild(b);
    });

    setMsg("看圖片，選正確的中文詞。", "");
    speak(current.zh);
  }

  function choose(opt){
    if(opt === current.zh){
      score += 1;
      scoreEl.textContent = String(score);
      setMsg("答對了！這是「" + current.zh + "」。", "ok");
      speak("答對了，" + current.zh);
      // 0.8 秒後自動下一題
      setTimeout(newRound, 800);
    }else{
      setMsg("再試一次。提示：它比較「" + current.hint + "」。", "bad");
      speak("再試一次");
    }
  }

  // --- 簡化 SVG 圖示（分類用，不逼真） ---
  function baseSVG(inner){
    return `
    <svg width="320" height="200" viewBox="0 0 320 200" role="img" aria-label="圖示">
      <rect x="14" y="14" width="292" height="172" rx="18" fill="#ffffff" stroke="#e8e8e8"/>
      ${inner}
    </svg>`;
  }

  function pistolSVG(){
    return baseSVG(`
      <text x="28" y="44" font-size="14" fill="#666">小</text>
      <rect x="80" y="78" width="130" height="18" rx="6" fill="#cfd8ff"/>
      <rect x="188" y="70" width="55" height="10" rx="5" fill="#cfd8ff"/>
      <rect x="120" y="96" width="26" height="55" rx="8" fill="#cfd8ff"/>
      <circle cx="133" cy="136" r="6" fill="#b7c3ff"/>
    `);
  }

  function rifleSVG(){
    return baseSVG(`
      <text x="28" y="44" font-size="14" fill="#666">長</text>
      <rect x="46" y="92" width="230" height="14" rx="7" fill="#cfe8ff"/>
      <rect x="240" y="86" width="36" height="6" rx="3" fill="#cfe8ff"/>
      <rect x="90" y="106" width="30" height="36" rx="8" fill="#cfe8ff"/>
      <rect x="56" y="86" width="28" height="10" rx="5" fill="#cfe8ff"/>
    `);
  }

  function shotgunSVG(){
    return baseSVG(`
      <text x="28" y="44" font-size="14" fill="#666">吵</text>
      <rect x="52" y="94" width="220" height="18" rx="9" fill="#ffe3c7"/>
      <rect x="230" y="86" width="42" height="8" rx="4" fill="#ffe3c7"/>
      <path d="M70 112 Q92 140 120 146" stroke="#ffd3a6" stroke-width="10" fill="none" stroke-linecap="round"/>
      <circle cx="268" cy="103" r="2" fill="#d9a67a"/>
      <circle cx="276" cy="103" r="2" fill="#d9a67a"/>
    `);
  }

  function smgSVG(){
    return baseSVG(`
      <text x="28" y="44" font-size="14" fill="#666">快</text>
      <rect x="62" y="92" width="180" height="14" rx="7" fill="#d7ffd7"/>
      <rect x="214" y="86" width="28" height="6" rx="3" fill="#d7ffd7"/>
      <rect x="118" y="106" width="22" height="52" rx="7" fill="#d7ffd7"/>
      <rect x="142" y="120" width="18" height="44" rx="6" fill="#c1f7c1"/>
      <path d="M250 92 l14 -10" stroke="#a7eaa7" stroke-width="4" />
      <path d="M254 104 l16 -10" stroke="#a7eaa7" stroke-width="4" />
    `);
  }

  function sniperSVG(){
    return baseSVG(`
      <text x="28" y="44" font-size="14" fill="#666">準</text>
      <rect x="44" y="96" width="240" height="10" rx="5" fill="#e9dcff"/>
      <rect x="200" y="76" width="54" height="12" rx="6" fill="#e9dcff"/>
      <circle cx="228" cy="82" r="10" fill="#d9c8ff"/>
      <line x1="228" y1="72" x2="228" y2="92" stroke="#bca6ff" stroke-width="2"/>
      <line x1="218" y1="82" x2="238" y2="82" stroke="#bca6ff" stroke-width="2"/>
    `);
  }

  function mgSVG(){
    return baseSVG(`
      <text x="28" y="44" font-size="14" fill="#666">很大</text>
      <rect x="54" y="88" width="210" height="18" rx="9" fill="#ffd6e6"/>
      <rect x="86" y="106" width="40" height="50" rx="10" fill="#ffd6e6"/>
      <rect x="136" y="112" width="34" height="44" rx="8" fill="#fbb8d1"/>
      <rect x="244" y="82" width="20" height="6" rx="3" fill="#ffd6e6"/>
      <path d="M58 146 L86 156" stroke="#f49fbf" stroke-width="6" stroke-linecap="round"/>
      <path d="M254 88 l10 -10" stroke="#f49fbf" stroke-width="4" />
    `);
  }

  // start
  newRound();
</script>
</body>
</html>
